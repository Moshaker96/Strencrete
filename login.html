<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Firebase Login Test</title>
</head>
<body>
  <form id="loginForm" autocomplete="off">
    <input id="email" type="email" required placeholder="Email" /><br>
    <div id="passwordContainer" style="display:none;">
      <input id="password" type="password" required placeholder="Password" /><br>
    </div>
    <button type="submit" id="submitBtn">Continue</button>
    <div id="messageBox"></div>
  </form>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
    import { getAuth, fetchSignInMethodsForEmail, signInWithEmailAndPassword, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-auth.js";
    const firebaseConfig = { /* ...your config... */ };
    initializeApp(firebaseConfig);
    const auth = getAuth();
    const loginForm = document.getElementById('loginForm');
    const emailInput = document.getElementById('email');
    const passwordContainer = document.getElementById('passwordContainer');
    const passwordInput = document.getElementById('password');
    const submitBtn = document.getElementById('submitBtn');
    const messageBox = document.getElementById('messageBox');
    loginForm.addEventListener('submit', async (e) => {
      console.log("Form submitted!"); // Should always appear
      e.preventDefault();
      const email = emailInput.value.trim();
      const password = passwordInput.value;
      if (submitBtn.textContent === 'Continue') {
        const methods = await fetchSignInMethodsForEmail(auth, email);
        if (methods.length === 0) {
          messageBox.textContent = "No user. Enter password to create account.";
          passwordContainer.style.display = "";
          submitBtn.textContent = "Create Account";
        } else {
          messageBox.textContent = "Enter your password to sign in.";
          passwordContainer.style.display = "";
          submitBtn.textContent = "Sign In";
        }
      } else if (submitBtn.textContent === 'Sign In') {
        await signInWithEmailAndPassword(auth, email, password);
        messageBox.textContent = "Signed in!";
      } else if (submitBtn.textContent === 'Create Account') {
        await createUserWithEmailAndPassword(auth, email, password);
        messageBox.textContent = "Account created!";
      }
    });
  </script>
</body>
</html>
